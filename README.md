[![Server Status](https://img.shields.io/website?url=https%3A%2F%2Fbadges.cssnr.com%2F&up_message=online&down_message=offline&logo=nodedotjs&logoColor=white&label=server)](https://badges.cssnr.com/)
[![Image Size](https://badges.cssnr.com/ghcr/size/smashedr/node-badges)](https://github.com/smashedr/node-badges/pkgs/container/node-badges)
[![Image Latest](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges/latest)](https://github.com/smashedr/node-badges/pkgs/container/node-badges)
[![Image Tags](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges)](https://github.com/smashedr/node-badges/pkgs/container/node-badges)
[![GitHub Tag Major](https://img.shields.io/github/v/tag/smashedr/node-badges?sort=semver&filter=!*.*&logo=git&logoColor=white&labelColor=585858&label=%20)](https://github.com/smashedr/node-badges/tags)
[![GitHub Tag Minor](https://img.shields.io/github/v/tag/smashedr/node-badges?sort=semver&filter=!*.*.*&logo=git&logoColor=white&labelColor=585858&label=%20)](https://github.com/smashedr/node-badges/releases)
[![GitHub Release Version](https://img.shields.io/github/v/release/smashedr/node-badges?logo=github)](https://github.com/smashedr/node-badges/releases/latest)
[![Deployments Swarm](https://img.shields.io/github/deployments/smashedr/node-badges/swarm?logo=portainer&logoColor=white&label=swarm)](https://github.com/smashedr/node-badges/deployments/swarm)
[![Workflow Build](https://img.shields.io/github/actions/workflow/status/smashedr/node-badges/build.yaml?logo=cachet&label=build)](https://github.com/smashedr/node-badges/actions/workflows/build.yaml)
[![Workflow Lint](https://img.shields.io/github/actions/workflow/status/smashedr/node-badges/lint.yaml?logo=cachet&label=lint)](https://github.com/smashedr/node-badges/actions/workflows/lint.yaml)
[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=smashedr_node-badges&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=smashedr_node-badges)
[![GitHub Last Commit](https://img.shields.io/github/last-commit/smashedr/node-badges?logo=github&label=updated)](https://github.com/smashedr/node-badges/pulse)
[![GitHub Contributors](https://img.shields.io/github/contributors-anon/smashedr/node-badges?logo=github)](https://github.com/smashedr/node-badges/graphs/contributors)
[![GitHub Repo Size](https://img.shields.io/github/repo-size/smashedr/node-badges?logo=bookstack&logoColor=white&label=repo%20size)](https://github.com/smashedr/node-badges?tab=readme-ov-file#readme)
[![GitHub Top Language](https://img.shields.io/github/languages/top/smashedr/node-badges?logo=htmx)](https://github.com/smashedr/node-badges/tree/master/src)
[![GitHub Discussions](https://img.shields.io/github/discussions/smashedr/node-badges?logo=github)](https://github.com/smashedr/node-badges/discussions)
[![GitHub Forks](https://img.shields.io/github/forks/smashedr/node-badges?style=flat&logo=github)](https://github.com/smashedr/node-badges/forks)
[![GitHub Repo Stars](https://img.shields.io/github/stars/smashedr/node-badges?style=flat&logo=github)](https://github.com/smashedr/node-badges/stargazers)
[![GitHub Org Stars](https://img.shields.io/github/stars/cssnr?style=flat&logo=github&label=org%20stars)](https://cssnr.github.io/)
[![Discord](https://img.shields.io/discord/899171661457293343?logo=discord&logoColor=white&label=discord&color=7289da)](https://discord.gg/wXy6m2X8wY)
[![Ko-fi](https://img.shields.io/badge/Ko--fi-72a5f2?logo=kofi&label=support)](https://ko-fi.com/cssnr)

# Node Badges

This is a Work in Progress, but Works!

Badges include GitHub Container Registry (GHCR) Image Size and Tags.

[![Image Size](https://badges.cssnr.com/ghcr/size/smashedr/node-badges)](https://badges.cssnr.com/ghcr/size/smashedr/node-badges)
[![Image Latest](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges/latest)](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges/latest)
[![Image Tags](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges)](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges)

Please [let us know](https://github.com/smashedr/node-badges/discussions/categories/feature-requests) if you want to see a specific badge or feature....

- [Badges](#Badges)
  - [GHCR Image Size](#ghcr-image-size)
  - [GHCR Image Tags](#ghcr-image-tags)
- [Query Parameters](#query-parameters)
  - [Badge Specific Parameters](#badge-specific-parameters)
- [Troubleshooting](#Troubleshooting)
- [Developing](#Developing)
- [Deploying](#Deploying)
- [Support](#Support)
- [Contributing](#Contributing)

Public Server Base URL:

```text
https://badges.cssnr.com/
```

[![Server Status](https://img.shields.io/website?url=https%3A%2F%2Fbadges.cssnr.com%2F&up_message=online&down_message=offline&style=for-the-badge&logo=nodedotjs&logoColor=white&label=server)](https://badges.cssnr.com/)
[![Uptime](https://badges.cssnr.com/uptime?style=for-the-badge)](https://badges.cssnr.com/uptime?style=for-the-badge)

## Badges

Available Badges:

- [GHCR Image Size](#ghcr-image-size)
- [GHCR Image Tags (2)](#ghcr-image-tags)

### GHCR Image Size

[![Image Size](https://badges.cssnr.com/ghcr/size/smashedr/node-badges)](https://badges.cssnr.com/ghcr/size/smashedr/node-badges)

`/ghcr/size/{owner}/{pacakge}/{tag}?`

Without the `tag` it defaults to `latest`, these are equivalent.

- https://badges.cssnr.com/ghcr/size/smashedr/node-badges
- https://badges.cssnr.com/ghcr/size/smashedr/node-badges/latest

_For more options see the [Query Parameters](#query-parameters)._

[![Image Size](https://badges.cssnr.com/ghcr/size/smashedr/node-badges?labelColor=blueviolet&lucide=scale&color=seagreen&style=for-the-badge&label=node%20badges)](https://badges.cssnr.com/ghcr/size/smashedr/node-badges?labelColor=blueviolet&lucide=scale&color=seagreen&style=for-the-badge&label=node%20badges)

```text
https://badges.cssnr.com/ghcr/size/smashedr/node-badges?labelColor=blueviolet&lucide=scale&color=seagreen&style=for-the-badge&label=node%20badges
```

### GHCR Image Tags

[![Image Latest](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges/latest)](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges/latest)
[![Image Tags](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges)](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges)

`/ghcr/tags/{owner}/{pacakge}/{tag}/latest?`

Without `latest` it returns the `n` most recent tags, otherwise only the latest tag.

- https://badges.cssnr.com/ghcr/tags/smashedr/node-badges
- https://badges.cssnr.com/ghcr/tags/smashedr/node-badges/latest

The `n` [parameter](#badge-specific-parameters) defaults to `3`, these are equivalent.

```text
http://badges.cssnr.com/ghcr/tags/smashedr/node-badges
http://badges.cssnr.com/ghcr/tags/smashedr/node-badges?n=3
```

You can also change the `sep` parameter, add `reversed` and filter by valid `semver` tags.

[![Image Tags](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges?labelColor=blue&lucide=activity&color=olivedrab&style=for-the-badge&label=last%20four&n=4&sep=-&reversed&semver)](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges?labelColor=blue&lucide=activity&color=crimson&style=for-the-badge&label=last%20four&n=4&sep=-&reversed&semver)

```text
https://badges.cssnr.com/ghcr/tags/smashedr/node-badges?labelColor=blue&lucide=activity&color=crimson&style=for-the-badge&label=last%20four&n=4&sep=-&reversed&semver
```

### YAML JSONPath

`/yaml/{url}/{path}`

Both `url` and `path` are URL encoded. The `path` is a [JSONPath](https://jsonpath.com/).

This endpoint accepts `split` and `index`.

## Query Parameters

The following query parameters are supported on all badges.

| Parameter    | Default&nbsp;Param&nbsp;Value | Description&nbsp;of&nbsp;the&nbsp;Parameter                 |
| :----------- | :---------------------------: | :---------------------------------------------------------- |
| `style`      |            `flat`             | `plastic`, `flat`, `flat-square`, `for-the-badge`, `social` |
| `color`      |         `brightgreen`         | Badge Background Color (right side)                         |
| `label`      |        badge specific         | Label Text (left side)                                      |
| `labelColor` |            `#555`             | Label Background Color (left side)                          |
| `lucide`     |        badge specific         | Name of a [Lucide Icon](https://lucide.dev/icons/)          |
| `iconColor`  |            `#fff`             | Icon Color                                                  |

For more details see the documentation for the related library, [badge-maker](https://www.npmjs.com/package/badge-maker).

### Badge Specific Parameters

These are specific to certain badges. Refer to the [Badges](#badges) for more details.

| Parameter  | Example | Description&nbsp;of&nbsp;the&nbsp;Parameter                                      |
| :--------- | :-----: | :------------------------------------------------------------------------------- |
| `n`        |   `3`   | Number of items to include in the badge.                                         |
| `sep`      |  `\|`   | List item seperator where applicable.                                            |
| `semver`   |    -    | Filter items by valid [semantic](https://www.npmjs.com/package/semver) versions. |
| `reversed` |    -    | Reverse the order of returned items.                                             |
| `split`    |    -    | Split the item at the delimiter.                                                 |
| `index`    |   `0`   | Index of item after splitting.                                                   |

## Troubleshooting

GitHub's media proxy caches images for 1 hour. You can purge the cache by sending a PURGE request.

```text
curl -X PURGE 'https://camo.githubusercontent.com/xxx'
```

This application caches API responses for 1 hour. Currently, there is no endpoint to purge this cache.  
Only the API response is cached, not the badge. All query parameters changes will instantly update.

# Developing

You can run the dev server with [Docker](#with-docker) compose or [Node](#with-node) run.

[Docker](#with-docker) is highly recommended because of the required redis server.

### With Docker

I use Docker because it includes the redis container, and live reloads with the dev server.

```shell
docker compose -f "docker-compose-dev.yaml" up --build --remove-orphans --force-recreate
```

Then visit: http://localhost/

Note: this mounts the `./src` directory into the container for live reloading.
To use a different source path, set the `APP_FILES` environment variable.
See the [docker-compose-dev.yaml](docker-compose-dev.yaml) file for more details.

To use a different port set the `PORT` environment variable.

```shell
export PORT=8080
```

### With Node

Make sure you have a redis server running and set the `REDIS_URL` environment variable.

```shell
export REDIS_URL=redis://localhost:6379
npm i
npm run dev
```

Then visit: http://localhost:3000/

To use a different port set the `PORT` environment variable.

```shell
export PORT=8080
```

# Deploying

This is ready for deployment using both [Docker](#to-docker) and [Node](#to-node).
If using Node you need a Redis server.

### To Docker

This is designed to be deployed to Docker out of the box which includes redis.

To deploy to a Swarm cluster using Traefik seee the [docker-compose-swarm.yaml](docker-compose-swarm.yaml).

### To Node

This is ready to be deployed to services like Render assuming you have a redis server.
You can set the redis server url with the `REDIS_URL` environment variable.  
The default value is `redis://redis:6379`.

The server installs with `npm i`, starts with `npm start`, and listens on `PORT` environment variable.

To use without redis, install `node-cache`, comment out the redis lines, and uncomment the node-cache lines.

# Support

For general help or to request a feature, see:

- Q&A Discussion: https://github.com/smashedr/node-badges/discussions/categories/q-a
- Request a Feature: https://github.com/smashedr/node-badges/discussions/categories/feature-requests

If you are experiencing an issue/bug or getting unexpected results, you can:

- Report an Issue: https://github.com/smashedr/node-badges/issues
- Chat with us on Discord: https://discord.gg/wXy6m2X8wY
- Provide General Feedback: [https://cssnr.github.io/feedback/](https://cssnr.github.io/feedback/?app=Node%20Badges)

For more information, see the CSSNR [SUPPORT.md](https://github.com/cssnr/.github/blob/master/.github/SUPPORT.md#support).

# Contributing

If you would like to submit a PR, please review the [CONTRIBUTING.md](#contributing-ov-file).

Please consider making a donation to support the development of this project
and [additional](https://cssnr.com/) open source projects.

[![Ko-fi](https://ko-fi.com/img/githubbutton_sm.svg)](https://ko-fi.com/cssnr)

For a full list of current projects visit: [https://cssnr.github.io/](https://cssnr.github.io/)
