[![Server Status](https://img.shields.io/website?url=https%3A%2F%2Fbadges.cssnr.com%2F&up_message=online&down_message=offline&logo=nodedotjs&logoColor=white&label=server)](https://badges.cssnr.com/)
[![Image Size](https://badges.cssnr.com/ghcr/size/smashedr/node-badges)](https://github.com/smashedr/node-badges/pkgs/container/node-badges)
[![Image Latest](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges/latest)](https://github.com/smashedr/node-badges/pkgs/container/node-badges)
[![Image Tags](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges)](https://github.com/smashedr/node-badges/pkgs/container/node-badges)
[![GitHub Release Version](https://img.shields.io/github/v/release/smashedr/node-badges?logo=github)](https://github.com/smashedr/node-badges/releases/latest)
[![Deployments Pages](https://img.shields.io/github/deployments/smashedr/node-badges/swarm?logo=portainer&logoColor=white&label=swarm)](https://github.com/smashedr/node-badges/deployments/swarm)
[![Workflow Build](https://img.shields.io/github/actions/workflow/status/smashedr/node-badges/build.yaml?logo=cachet&label=build)](https://github.com/smashedr/node-badges/actions/workflows/build.yaml)
[![Workflow Lint](https://img.shields.io/github/actions/workflow/status/smashedr/node-badges/lint.yaml?logo=cachet&label=lint)](https://github.com/smashedr/node-badges/actions/workflows/lint.yaml)
[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=smashedr_node-badges&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=smashedr_node-badges)
[![GitHub Last Commit](https://img.shields.io/github/last-commit/smashedr/node-badges?logo=github&label=updated)](https://github.com/smashedr/node-badges/pulse)
[![GitHub Contributors](https://img.shields.io/github/contributors-anon/smashedr/node-badges?logo=github)](https://github.com/smashedr/node-badges/graphs/contributors)
[![GitHub Repo Size](https://img.shields.io/github/repo-size/smashedr/node-badges?logo=bookstack&logoColor=white&label=repo%20size)](https://github.com/smashedr/node-badges?tab=readme-ov-file#readme)
[![GitHub Top Language](https://img.shields.io/github/languages/top/smashedr/node-badges?logo=htmx)](https://github.com/smashedr/node-badges/tree/master/src)
[![GitHub Discussions](https://img.shields.io/github/discussions/smashedr/node-badges?logo=github)](https://github.com/smashedr/node-badges/discussions)
[![GitHub Forks](https://img.shields.io/github/forks/smashedr/node-badges?style=flat&logo=github)](https://github.com/smashedr/node-badges/forks)
[![GitHub Repo Stars](https://img.shields.io/github/stars/smashedr/node-badges?style=flat&logo=github)](https://github.com/smashedr/node-badges/stargazers)
[![GitHub Org Stars](https://img.shields.io/github/stars/cssnr?style=flat&logo=github&label=org%20stars)](https://cssnr.github.io/)
[![Discord](https://img.shields.io/discord/899171661457293343?logo=discord&logoColor=white&label=discord&color=7289da)](https://discord.gg/wXy6m2X8wY)
[![Ko-fi](https://img.shields.io/badge/Ko--fi-72a5f2?logo=kofi&label=support)](https://ko-fi.com/cssnr)

# Node Badges

This is a Work in Progress, but Works!

Currently, this supports GitHub Container Registry (GHCR) Image Size and Tags.

Please [let us know](https://github.com/smashedr/node-badges/discussions/categories/feature-requests) if you want to see a specific badge or feature....

[![Image Size](https://badges.cssnr.com/ghcr/size/smashedr/node-badges)](https://badges.cssnr.com/ghcr/size/smashedr/node-badges)
[![Image Latest](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges/latest)](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges/latest)
[![Image Tags](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges)](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges)

- [Badges](#badges)
  - [GHCR Image Size](#ghcr-image-size)
  - [GHCR Image Tags](#ghcr-image-tags)
- [Query Parameters](#query-parameters)
  - [Badge Specific Parameters](#badge-specific-parameters)
- [Troubleshooting](#Troubleshooting)
- [Development](#development)

[![Server Status](https://img.shields.io/website?url=https%3A%2F%2Fbadges.cssnr.com%2F&up_message=online&down_message=offline&style=for-the-badge&logo=nodedotjs&logoColor=white&label=server)](https://badges.cssnr.com/)
[![Uptime](https://badges.cssnr.com/uptime?style=for-the-badge)](https://badges.cssnr.com/uptime?style=for-the-badge)

## Badges

Available Badges:

- [GHCR Image Size](#ghcr-image-size)
- [GHCR Image Tags (2)](#ghcr-image-tags)

### GHCR Image Size

[![Image Size](https://badges.cssnr.com/ghcr/size/smashedr/node-badges)](https://badges.cssnr.com/ghcr/size/smashedr/node-badges)

`/ghcr/size/{owner}/{pacakge}/{tag}?`

Without the `tag` it defaults to `latest`, these are equivalent.

- https://badges.cssnr.com/ghcr/size/smashedr/node-badges
- https://badges.cssnr.com/ghcr/size/smashedr/node-badges/latest

_For more options see the [Query Parameters](#query-parameters)._

[![Image Size](https://badges.cssnr.com/ghcr/size/smashedr/node-badges?labelColor=blueviolet&lucide=scale&color=seagreen&style=for-the-badge&label=node%20badges)](https://badges.cssnr.com/ghcr/size/smashedr/node-badges?labelColor=blueviolet&lucide=scale&color=seagreen&style=for-the-badge&label=node%20badges)

```text
https://badges.cssnr.com/ghcr/size/smashedr/node-badges?labelColor=blueviolet&lucide=scale&color=seagreen&style=for-the-badge&label=node%20badges
```

### GHCR Image Tags

[![Image Latest](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges/latest)](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges/latest)
[![Image Tags](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges)](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges)

`/ghcr/tags/{owner}/{pacakge}/{tag}/latest?`

Without `latest` it returns the `n` most recent tags, otherwise only the latest tag.

- https://badges.cssnr.com/ghcr/tags/smashedr/node-badges
- https://badges.cssnr.com/ghcr/tags/smashedr/node-badges/latest

The `n` [parameter](#badge-specific-parameters) defaults to `3`, these are equivalent.

```text
http://badges.cssnr.com/ghcr/tags/smashedr/node-badges
http://badges.cssnr.com/ghcr/tags/smashedr/node-badges?n=3
```

You can also change the `sep` parameter and add `reversed` to reverse the order.

[![Image Tags](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges?labelColor=blue&lucide=activity&color=crimson&style=for-the-badge&label=last%20two&n=2&sep=-&reversed)](https://badges.cssnr.com/ghcr/tags/smashedr/node-badges?labelColor=blue&lucide=activity&color=crimson&style=for-the-badge&label=last%20two&n=2&sep=-&reversed)

```text
https://badges.cssnr.com/ghcr/tags/smashedr/node-badges?labelColor=blue&lucide=activity&color=crimson&style=for-the-badge&label=last%20two&n=2&sep=-&reversed
```

## Query Parameters

The following query parameters are supported on all badges.

| Parameter    | Default&nbsp;Param&nbsp;Value | Description&nbsp;of&nbsp;the&nbsp;Parameter                 |
| :----------- | :---------------------------: | :---------------------------------------------------------- |
| `style`      |            `flat`             | `plastic`, `flat`, `flat-square`, `for-the-badge`, `social` |
| `color`      |         `brightgreen`         | Badge Background Color (right side)                         |
| `label`      |        badge specific         | Label Text (left side)                                      |
| `labelColor` |            `#555`             | Label Background Color (left side)                          |
| `lucide`     |        badge specific         | Name of a [Lucide Icon](https://lucide.dev/icons/)          |
| `iconColor`  |            `#fff`             | Icon Color                                                  |

For more details see the documentation for the related library, [badge-maker](https://www.npmjs.com/package/badge-maker).

### Badge Specific Parameters

These are specific to certain badges. Refer to the [Badges](#badges) for more details.

| Parameter  | Example | Description&nbsp;of&nbsp;the&nbsp;Parameter |
| :--------- | :-----: | :------------------------------------------ |
| `n`        |   `3`   | Number of items to include in the badge.    |
| `sep`      |  `\|`   | List item seperator where applicable.       |
| `reversed` |    -    | Reverse the order of returned items.        |

## Troubleshooting

GitHub's media proxy caches images for 1 hour. You can purge the cache by sending a PURGE request.

```text
curl -X PURGE 'https://camo.githubusercontent.com/xxx'
```

This application caches API responses for 1 hour. Currently, there is no endpoint to purge this cache.  
Only the API response is cached, not the badge. All query parameters changes will instantly update.

# Development

You can run the dev server with [Docker](#docker) compose or [NPM](#npm) run.

[Docker](#docker) is highly recommended because of the required redis server.

## Docker

I use Docker because it includes the redis container, and live reloads with the dev server.

```shell
docker compose -f "docker-compose-dev.yaml" up --build --remove-orphans --force-recreate
```

Then visit: http://localhost/

Note: this mounts the `./src` directory into the container for live reloading.
To use a different source path, set the `APP_FILES` environment variable.
See the [docker-compose-dev.yaml](docker-compose-dev.yaml) file for more details.

To use a different port set the `PORT` environment variable.

```shell
export PORT=8080
```

## NPM

Make sure you have a redis server running and set the `REDIS_URL` environment variable.

```shell
export REDIS_URL=redis://localhost:6379
npm i
npm run dev
```

Then visit: http://localhost:3000/

To use a different port set the `PORT` environment variable.

```shell
export PORT=8080
```
